---
title: Nuke使用liveGroup（分子流程化）+脚本，实现视频图片多流程统一
tags: ["Nuke","工作流程","计算机","影視"]
updated: 2020-09-05
date: 2020-09-05
categories: "影視"
---
---

>
# TL;DR

通过Nuke使用liveGroup（分子流程化）+脚本，实现：

1. 子流程的结构步骤统一，不同图允许方案的差异保存
2. 流程的自动化无需每次重复构建，让我们脱离出流程执行本身，更注重流程的结果
3. 图片、视频流程二合一，能存储大量的合成方案文件，体积极小
4. 允许多个方案之间进行参数混合，构建新的混合方案

<!--more-->

# 问题描述与思路

Nuke的核心优势在于可以灵活切分多个工作流程，假设现在已有的两个流程：

假设曾经的C4D出图：
- PS中锐化、柔光、色偏、加ps水印

假设曾经的C4D出片：
- AE中锐化、柔光、色偏、filmconverter风格化调色、加ae个人动态水印

但是这样遇到的问题如下：
1. 如何确保子流程的结构步骤统一
2. 多张图之间的差异如何在确保结构步骤统一的情况下保存差异
3. 多张图、多个片之间的流程参数分开保存，存量巨大
4. 多张图本身色彩不统一，一部分还需要一个``预校色``流程
5. 如果我需要混合一组图里第一张图与第五张图的参数，无迹可寻。

# 工具简介

Nuke使用liveGroup动态连接一个流程组，使得如锐化、柔光等，都可以脱离成为单个分子流程。
**使我们从执行流程本身，转变为流程的定制者。**

1. liveGroup允许包装一个流程，如锐化，并在``里流程``向上级引用，进而``将关键数据接口暴露给调用者``（用OOP的思想来说，就是“类的封装”）。比如暴露锐化流程的锐化程度、锐化流程里提取边缘的范围参数，最终的mix程度。

> *使用类的封装思维解决了第一二个问题*，使用liveGroup实现流程统一化，使用暴露的接口实现差异化效果

![](/asset/images/技术/nuke_process/01.png)

![](/asset/images/技术/nuke_process/02.png)

2. 对于nuke来说，不保存计算中间结果（如PS的盖印、蒙版提取，都算中间结果），且nuke文件原本只记录流程，所以体积极小。所以分开多个保存并没有问题。

3. 色彩不统一所产生的问题，由自身图片进行校色完成

![](/asset/images/技术/nuke_process/03.png)

在图中简单构建了允许**同一锐化流程多个方案、视频+图片方案，同时集成一个流程管理之中**。这样的流程化使得整个出图构建更加客观便捷：

1. 子流程的结构步骤统一，不同图允许方案的差异保存
2. 流程的自动化无需每次重复构建，让我们脱离出流程执行本身，更注重流程的结果
3. 图片、视频流程二合一，能存储大量的合成方案文件，体积极小
4. 允许多个方案之间进行参数混合，构建新的混合方案

# 尾声
最后附上配合同步liveGroup使用的全检查Reload脚本：
因为多个liveGroup指向同一个子流程，编辑后不会主动同步，需要一个个去点Reload
为了省去麻烦简单写了个全循环检查。
```py
for node in nuke.allNodes():
    try:
        print node.knob("reload_script").execute()
    except:
        continue
```

使用knob触发即可。
