---
title: 使用git簡單合併pr多版本，剪輯與調色同期進行
tags: ["Pr","影視"]
updated: 2019-01-14
date: 2019-01-14
categories: "影視"
---

![](/asset/images/技术/prgit/icon.jpg)

## 緣起

因為朋友問到``怎麼才能剪輯與調色同時進行，最後合併``，第一個反應是用git來管理。如果使用pr內建的方法的話，新的原聲pr都用lumetri調色（或者你們自用插件），方法基本就是導入導出預設而已。

勾起了想在pr外面套一層git管理的慾望。

## TL;DR
> pr工程文件是gz打包的xml文件，但pr操作對對象的記錄卻隨時間順序不同而不同，所以使用git合併會導致素材引用混亂引起錯誤。
>
> 1. 原問題解決方案：還是用預設導入導出吧
> 2. git合併解決方案：在導入素材後先在工程內構建引用對象再簽出
> 3. 結論：pr因為以時序編號對象，不適合使用版本管理器
> 4. 建議：直接拉到最下面看結論
<!--more-->
## 開始

1. prporj實質上是使用gz打包壓縮的xml文件，創建文件後保存解壓即可看到
    ![](/asset/images/技术/prgit/01.jpg)
    左邊為prproj文件，gz壓縮格式的二進制，右邊是解壓後的工程文件
    ![](/asset/images/技术/prgit/02.jpg)

2. 在工程文件夾構建git版本管理器、提交初始版本
    ![](/asset/images/技术/prgit/03.jpg)
    可以看到第一次提交的有prproj以及解壓出來的文件這兩個
    ![](/asset/images/技术/prgit/04.jpg)

3. 創建並簽出分支，開始導入素材，保存並解壓獲得一個擁有素材的xml文件
    ![](/asset/images/技术/prgit/05.jpg)
    ![](/asset/images/技术/prgit/06.jpg)
    ![](/asset/images/技术/prgit/07.jpg)

4. 添加完素材開始多人同步工作：簽出剪輯、調色兩個分支

5. 簡單對素材進行調色，並保存
    ![](/asset/images/技术/prgit/08.jpg)
    git發現prproj有變化，將其解壓出xml。
    解壓出來的xml文件會直接覆蓋原文件，在版本管理工具裡可以看到修改的內容：其中多了幾行對素材文件的追踪與歷史記錄的內容
    ![](/asset/images/技术/prgit/09.jpg)
    提交即可看到新的提交
    ![](/asset/images/技术/prgit/10.jpg)

6. 簽出到剪輯分支，做一個簡單剪輯
    ![](/asset/images/技术/prgit/11.jpg)
    解壓後也可以看到新增了對於剪輯的描述
    ![](/asset/images/技术/prgit/12.jpg)
    提交確認後可以看到從素材分支叉開了兩個分支：
    ![](/asset/images/技术/prgit/13.jpg)
    工程結構上這兩個結構是解耦的，但是pr……
    ![](/asset/images/技术/prgit/14.jpg)
    ![](/asset/images/技术/prgit/15.jpg)

7. 喵的pr你的底層引用結構我服
    ![](/asset/images/技术/prgit/16.jpg)
    ![](/asset/images/技术/prgit/17.jpg)


## 結論
原理上進行合併都是OK的，pr內部對obj對象的編號機制不是採用散列，而是使用隨時間增長的正序數。

這就直接導致剪輯裡對同一段素材的引用是57、58，在調色的素材裡因為添加了lumetri，而變成了154、155

建議如果是開始嘗試使用git管理pr工程的話，可以開始考慮在一開始導入素材的時候，簽出調色前再添加一個把所有素材都添上效果器

## 另：pr這麼不耐用怎麼還有這麼多人用？

~~FCP、Davinci不知道比你們高到哪裡去了，我跟他(們)談笑風生~~

吐槽針對``原生pr``一些不是必須有、但沒有很不爽的功能

- 效果器的節點式統一管理，ae的引用和表達式做得比較方便
- easy一點的剪輯工具（以最少正交基的工具集，參考Davinci）
- 沒有自建的素材代理算法加持（參考達芬奇）
- 沒有內建版本管理，簽出基本靠複製工程對象，造成空間時間浪費
- 沒有提供腳本編寫器應對批量素材處理等工具

![](/asset/images/技术/prgit/end.jpg)

pr作為一款入門到準專業級都適用的``剪輯集成工具``，已經是相當優秀的了（相比其他同等定位），帶我走進了一行走出了一行。

他是開始但不是結束，新的需求總會有新的工具出現，行業也因此欣欣向榮吧。